{% extends "base.html" %}
{% block title %}Orders in {{ container.container_name }}{% endblock %}

{% block content %}
<h2 class="mb-4">Orders in {{ container.container_name }}</h2>

{% if orders %}
<table class="table table-bordered table-striped table-sm">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      {% if "shipping_mark" in visible_fields %}<th>Shipping Mark</th>{% endif %}
      {% if "description" in visible_fields %}<th>Description</th>{% endif %}
      {% if "item_no_spec" in visible_fields %}<th>Item No./Specification</th>{% endif %}
      {% if "material" in visible_fields %}<th>Material</th>{% endif %}
      {% if "pictures" in visible_fields %}<th>Pictures</th>{% endif %}
      {% if "ctns" in visible_fields %}<th>CTNs</th>{% endif %}
      {% if "qty_per_ctn" in visible_fields %}<th>Qty/CTN</th>{% endif %}
      {% if "total_qty" in visible_fields %}<th>Total Qty</th>{% endif %}
      {% if "unit" in visible_fields %}<th>Unit</th>{% endif %}
      {% if "cbm_per_ctn" in visible_fields %}<th>CBM/CTN</th>{% endif %}
      {% if "cbm" in visible_fields %}<th>CBM</th>{% endif %}
      {% if "total_cbm" in visible_fields %}<th>Total CBM</th>{% endif %}
      {% if "wt_per_ctn" in visible_fields %}<th>Wt/CTN</th>{% endif %}
      {% if "total_wt" in visible_fields %}<th>Total Wt</th>{% endif %}
      {% if "supplier" in visible_fields %}<th>Supplier</th>{% endif %}
    </tr>
  </thead>
  <tbody>
    {% for order in orders %}
    <tr>
      <td>{{ forloop.counter }}</td>
      {% if "shipping_mark" in visible_fields %}<td>{{ order.shipping_mark }}</td>{% endif %}
      {% if "description" in visible_fields %}<td>{{ order.description }}</td>{% endif %}
      {% if "item_no_spec" in visible_fields %}<td>{{ order.item_no_spec }}</td>{% endif %}
      {% if "material" in visible_fields %}<td>{{ order.material }}</td>{% endif %}
      {% if "pictures" in visible_fields %}
        <td>
          {% if order.pictures %}
            <img src="{{ order.pictures.url }}" alt="Order Pic" style="width:60px;height:60px;object-fit:cover;">
          {% else %}
            -
          {% endif %}
        </td>
      {% endif %}
      {% if "ctns" in visible_fields %}<td>{{ order.ctns }}</td>{% endif %}
      {% if "qty_per_ctn" in visible_fields %}<td>{{ order.qty_per_ctn }}</td>{% endif %}
      {% if "total_qty" in visible_fields %}<td>{{ order.total_qty }}</td>{% endif %}
      {% if "unit" in visible_fields %}<td>{{ order.unit }}</td>{% endif %}
      {% if "cbm_per_ctn" in visible_fields %}<td>{{ order.cbm_per_ctn }}</td>{% endif %}
      {% if "cbm" in visible_fields %}<td>{{ order.cbm }}</td>{% endif %}
      {% if "total_cbm" in visible_fields %}<td>{{ order.total_cbm }}</td>{% endif %}
      {% if "wt_per_ctn" in visible_fields %}<td>{{ order.wt_per_ctn }}</td>{% endif %}
      {% if "total_wt" in visible_fields %}<td>{{ order.total_wt }}</td>{% endif %}
      {% if "supplier" in visible_fields %}<td>{{ order.supplier }}</td>{% endif %}
    </tr>
    {% endfor %}
  </tbody>
  <tfoot>
    {% if "total_qty" in visible_fields %}
    <tr class="table-warning">
      <th colspan="8" class="text-end">Total Quantity</th>
      <th>{{ total_qty_sum }}</th>
      <th colspan="7"></th>
    </tr>
    {% endif %}
  </tfoot>
</table>
{% else %}
<div class="alert alert-info">No orders found in this container.</div>
{% endif %}

<div class="mb-3">
  <a href="{% url 'export_orders_pdf' enc_container_id %}" class="btn btn-danger">
    Export PDF
  </a>
  <a href="{% url 'export_orders_excel' enc_container_id %}" class="btn btn-success">
    Export Excel
  </a>
</div>

<a href="{% url 'user_containers' %}" class="btn btn-secondary mt-3">Back to Containers</a>
{% endblock %}
